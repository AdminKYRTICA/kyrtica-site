<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kyrtica Marketplace — Wholesalers & Distributors</title>
<meta name="description" content="Discover verified Indian wholesalers, distributors and manufacturers. Compare bulk prices, MOQs, logistics, and credit eligibility. Order samples before bulk.">
<meta name="theme-color" content="#0e0e0e" />
<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml" />
<link rel="stylesheet" href="/styles.css?v=1" />
<style>
:root{
  --bg:#0b0b0b; --card:#141414; --muted:#9aa0a6; --text:#eaecef; --brand:#e5b700;
  --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444; --border:#1f1f1f; --max:1280px; --radius:14px;
  --shadow:0 10px 25px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
a{color:inherit;text-decoration:none}
img{max-width:100%;display:block}
button{cursor:pointer}
.container{max-width:var(--max);margin:0 auto;padding:0 18px}

/* ===== Header: copied from index ===== */
.site-header{position:sticky;top:0;z-index:30;background:rgba(11,11,11,.9);backdrop-filter:saturate(120%) blur(6px);border-bottom:1px solid var(--border)}
.navwrap{display:flex;align-items:center;gap:16px;min-height:68px}
.brand{display:flex;align-items:center;gap:10px;font-weight:900;letter-spacing:.2px}
.brand img{height:22px;width:auto}
.hamburger{display:none;flex-direction:column;gap:4px;background:transparent;border:0}
.hamburger span{display:block;width:22px;height:2px;background:#eaecef;border-radius:2px}
.menu{display:flex;gap:18px;margin-left:16px}
.menu a{opacity:.9}
.menu a:hover{opacity:1}
.right{margin-left:auto;display:flex;align-items:center;gap:10px}
.btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border)}
.btn-outline{background:#161616;color:#eaecef}
.btn-primary{background:var(--brand);border-color:#b39800;color:#111;font-weight:800}

/* Responsive header (same behavior as index.js expects) */
@media (max-width: 860px){
  .hamburger{display:flex}
  .menu{display:none;position:absolute;right:18px;top:68px;background:#0e0e0e;border:1px solid var(--border);border-radius:12px;padding:10px;flex-direction:column}
  .menu.show{display:flex}
}

/* Footer */
.site-footer{margin-top:40px;border-top:1px solid var(--border);background:#0e0e0e}
.footer-wrap{display:flex;justify-content:space-between;align-items:center;gap:16px;min-height:68px}

/* Toolbar */
.toolbar{padding:14px 0}
.toolbar .row{display:flex;gap:12px;flex-wrap:wrap}
.search{flex:1;display:flex;align-items:center;gap:8px;background:#101010;border:1px solid var(--border);padding:10px 12px;border-radius:12px}
.search input{flex:1;background:transparent;border:0;color:var(--text);outline:none}
.select,.btn{background:#101010;border:1px solid var(--border);color:var(--text);padding:10px 12px;border-radius:12px}
.badge{display:inline-flex;align-items:center;gap:6px;font-size:12px;background:#101010;border:1px dashed var(--border);padding:6px 8px;border-radius:30px;color:var(--muted)}
.badge .dot{width:7px;height:7px;border-radius:50%}
.dot.ok{background:var(--ok)} .dot.warn{background:var(--warn)} .dot.danger{background:var(--danger)}
.k-sep{height:1px;background:var(--border);margin:16px 0}

/* Layout */
.grid{display:grid;grid-template-columns:280px 1fr;gap:16px}
@media (max-width: 1000px){.grid{grid-template-columns:1fr}}
.sidebar{background:#0e0e0e;border:1px solid var(--border);border-radius:var(--radius);padding:14px;position:sticky;top:88px;height:fit-content}
.sidebar h4{margin:6px 0 10px 0;font-size:14px;color:#cfcfcf}
.facet{border-top:1px solid var(--border);padding:12px 0}
.facet:first-child{border-top:0}
.facet .row{display:flex;gap:8px;flex-wrap:wrap}
.facet label{display:flex;gap:8px;align-items:center;font-size:14px;color:#c9c9c9}
.facet input[type="checkbox"]{width:16px;height:16px}
.facet select,.facet input[type="number"]{width:100%;background:#101010;border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:10px;margin-top:8px}

/* Results */
.results{background:#0e0e0e;border:1px solid var(--border);border-radius:var(--radius);padding:14px}
.meta{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:8px}
.meta .count{color:var(--muted);font-size:14px}
.cards{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:14px}
@media (max-width: 1200px){.cards{grid-template-columns:repeat(3,minmax(0,1fr))}}
@media (max-width: 820px){.cards{grid-template-columns:repeat(2,minmax(0,1fr))}}
@media (max-width: 520px){.cards{grid-template-columns:1fr}}

.card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column}
.card .thumb{aspect-ratio:4/3;background:#0d0d0d;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:center;position:relative}
.card .thumb span{color:#666;font-size:12px}
.card .thumb .ribbon{position:absolute;left:8px;top:8px;background:rgba(229,183,0,.12);border:1px solid #4d3e00;color:#e5d37a;font-size:11px;padding:4px 7px;border-radius:8px}
.card .body{padding:12px;display:flex;flex-direction:column;gap:8px}
.card .title{font-size:14.5px;font-weight:700;line-height:1.35;min-height:40px}
.tags{display:flex;flex-wrap:wrap;gap:6px}
.tag{font-size:11px;border:1px solid var(--border);padding:4px 8px;border-radius:999px;color:#c8c8c8;background:#0f0f0f}
.tag.brand{border-color:#4d3e00;background:rgba(229,183,0,.08);color:#e5d37a}
.kv{display:flex;gap:8px;align-items:center;font-size:13px;color:#cfcfcf}
.kv b{color:#fff}
.tiers{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:6px}
.tier{background:#101010;border:1px solid var(--border);border-radius:10px;padding:8px;text-align:center}
.tier .q{font-size:11px;color:var(--muted)} .tier .p{font-size:13px;font-weight:800}
.card .foot{display:flex;gap:8px;margin-top:8px}
.btn-primary{background:var(--brand);border:1px solid #b39800;color:#111;font-weight:800}
.btn-ghost{background:#101010;border:1px solid var(--border);color:#e9e9e9}

/* Sample Cart */
.sample-drawer{position:sticky;bottom:16px;margin-top:16px;background:#0f0f0f;border:1px solid var(--border);border-radius:16px;padding:12px;box-shadow:var(--shadow)}
.sample-drawer h4{margin:0 0 8px 0}
.cart-line{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 0;border-top:1px dashed var(--border);font-size:13px}
.cart-line:first-child{border-top:0}
.qctrl{display:flex;align-items:center;gap:6px}
.qctrl button{width:26px;height:26px;border-radius:8px;border:1px solid var(--border);background:#121212;color:#eee}
.cart-actions{display:flex;gap:8px;margin-top:10px}
.small{font-size:12px;color:var(--muted)}

/* Pagination */
.pager{display:flex;justify-content:center;gap:8px;margin-top:18px}
.pager button{min-width:40px;height:40px;border-radius:10px;border:1px solid var(--border);background:#101010;color:#eaecef}
.pager .active{background:var(--brand);border-color:#b39800;color:#111;font-weight:800}

/* Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:16px;z-index:40}
.modal .panel{width:min(560px,95vw);background:#0f0f0f;border:1px solid var(--border);border-radius:16px;padding:16px}
.modal .row{display:flex;gap:8px;flex-wrap:wrap}
.modal input,.modal textarea{flex:1;min-width:200px;background:#101010;border:1px solid var(--border);color:#eaecef;border-radius:10px;padding:10px}
.modal .actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
</style>
</head>
<body>

<!-- ===== Header (same as index) ===== -->
<header class="site-header">
  <div class="container navwrap">
    <a class="brand" href="/">
      <img src="/assets/logo.svg" alt="Kyrtica" />
      Kyrtica
    </a>

    <button class="hamburger" aria-label="Toggle menu" aria-expanded="false" aria-controls="site-nav">
      <span></span><span></span><span></span>
    </button>

    <nav id="site-nav" class="menu">
      <a href="/marketplace/">Market place</a>
      <a href="/partner.html">Partner With Us</a>
      <a href="/#hubs">Hubs</a>
      <a href="/#services">Services</a>
      <a href="/#learning">Learning</a>
      <a href="/#contact">Contact</a>
    </nav>

    <div class="right">
      <select aria-label="Language & Currency">
        <option>English-INR</option>
        <option>தமிழ்-INR</option>
      </select>
      <a class="btn btn-outline" href="/#signin">Sign In</a>
      <a class="btn btn-primary" href="/#register">Register</a>
    </div>
  </div>
</header>

<main class="container" style="padding:14px 0 32px">
  <!-- Toolbar -->
  <section class="toolbar">
    <div class="row">
      <div class="search" style="flex:1">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m21 21-3.9-3.9M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#9aa0a6" stroke-width="1.8" stroke-linecap="round"/></svg>
        <input id="q" placeholder="Search products, brands, HS code..." />
      </div>
      <select id="sort" class="select">
        <option value="relevance">Sort: Relevance</option>
        <option value="priceAsc">Price (Low → High)</option>
        <option value="priceDesc">Price (High → Low)</option>
        <option value="moqAsc">MOQ (Low → High)</option>
        <option value="supplierAsc">Supplier A→Z</option>
      </select>
      <span class="badge"><span class="dot ok"></span> GST-Verified Only</span>
      <span class="badge"><span class="dot warn"></span> Credit-Eligible</span>
      <span class="badge"><span class="dot ok"></span> Dropship-Ready</span>
    </div>
  </section>
  <div class="k-sep"></div>

  <!-- Main grid -->
  <section class="grid">
    <!-- Sidebar -->
    <aside class="sidebar">
      <h4>Filter</h4>

      <div class="facet">
        <h4>Supplier Type</h4>
        <div class="row" id="facet-supplier-type"></div>
      </div>

      <div class="facet">
        <h4>Categories</h4>
        <div class="row" id="facet-categories"></div>
      </div>

      <div class="facet">
        <h4>Location (State)</h4>
        <select class="fx" data-key="state" id="facet-state"></select>
      </div>

      <div class="facet">
        <h4>Badges</h4>
        <div class="row">
          <label><input type="checkbox" class="fx" data-key="gstVerified" value="true" />GST-Verified</label>
          <label><input type="checkbox" class="fx" data-key="dropshipReady" value="true" />Dropship-Ready</label>
          <label><input type="checkbox" class="fx" data-key="creditEligible" value="true" />Credit-Eligible (NBFC)</label>
          <label><input type="checkbox" class="fx" data-key="logistics" value="true" />Kyrtica Fulfilled</label>
          <label><input type="checkbox" class="fx" data-key="brandPackaging" value="true" />Brand Packaging</label>
          <label><input type="checkbox" class="fx" data-key="ecoPack" value="true" />Eco-Packaging</label>
          <label><input type="checkbox" class="fx" data-key="sameDay" value="true" />Same-day Dispatch</label>
        </div>
      </div>

      <div class="facet">
        <h4>MOQ (≤)</h4>
        <input type="number" class="fx" data-key="moqMax" placeholder="e.g. 50" min="1" />
      </div>

      <div class="facet">
        <h4>Price (₹) per unit</h4>
        <div class="row" style="width:100%">
          <input type="number" class="fx" data-key="priceMin" placeholder="Min" min="0" style="flex:1" />
          <input type="number" class="fx" data-key="priceMax" placeholder="Max" min="0" style="flex:1" />
        </div>
      </div>

      <div class="facet">
        <button id="reset" class="btn" style="width:100%">Reset Filters</button>
      </div>

      <!-- Sample Cart Drawer -->
      <div class="sample-drawer">
        <h4>Sample Cart <span class="small" id="sample-count">(0 items)</span></h4>
        <div id="sample-lines"></div>
        <div class="cart-actions">
          <button class="btn" id="clear-samples">Clear</button>
          <button class="btn-cta btn" id="btn-request-samples" style="background:var(--brand);border-color:#b39800;color:#111;font-weight:800">Request Samples</button>
        </div>
        <div class="small" style="margin-top:6px">Select samples to evaluate quality before placing a bulk order. Typically pay shipping only.</div>
      </div>
    </aside>

    <!-- Results -->
    <section class="results">
      <div class="meta">
        <div class="count"><span id="count">0</span> results • B2B wholesale prices shown</div>
        <div>
          <span class="badge"><span class="dot ok"></span> Pan-India Logistics</span>
          <span class="badge"><span class="dot ok"></span> Buyer Protection</span>
        </div>
      </div>
      <div id="cards" class="cards"></div>
      <div class="pager" id="pager"></div>
    </section>
  </section>
</main>

<!-- ===== Footer (same as index style) ===== -->
<footer class="site-footer">
  <div class="container footer-wrap">
    <div>© <span id="yr"></span> Kyrtica — Built for Indian Business.</div>
    <div><a href="/partner.html">Partner With Us</a> • <a href="/marketplace/">Marketplace</a></div>
  </div>
</footer>

<!-- Modal -->
<div class="modal" id="sample-modal">
  <div class="panel">
    <h3 style="margin:0 0 8px 0">Request Samples</h3>
    <p class="small" id="sample-summary">You’re requesting samples for n items.</p>
    <div class="row" style="margin-top:6px">
      <input id="buyer-name" placeholder="Your Name" />
      <input id="buyer-phone" placeholder="Phone" />
      <input id="buyer-email" placeholder="Email" />
      <input id="buyer-city" placeholder="City" />
    </div>
    <textarea id="buyer-notes" rows="4" placeholder="Notes for suppliers (brand, packaging needs, GST, preferred courier, etc.)" style="margin-top:8px;width:100%"></textarea>
    <div class="actions">
      <button class="btn" id="close-modal">Cancel</button>
      <button class="btn-cta btn" id="submit-samples" style="background:var(--brand);border-color:#b39800;color:#111;font-weight:800">Submit Request</button>
    </div>
  </div>
</div>

<script src="/script.js"></script>
<script>
/* Header burger (in case script.js isn't loaded yet) */
const hb=document.querySelector('.hamburger'); const m=document.getElementById('site-nav');
hb?.addEventListener('click',()=>{ m.classList.toggle('show'); hb.setAttribute('aria-expanded', m.classList.contains('show')); });

document.getElementById('yr').textContent = new Date().getFullYear();

/* ===== MOCK DATA (100 items) ===== */
const STATES=["Karnataka","Maharashtra","Tamil Nadu","Gujarat","Delhi NCR","Rajasthan","Uttar Pradesh","Telangana","West Bengal","Punjab"];
const SUPPLIER_TYPES=["Wholesaler","Distributor","Manufacturer","Importer"];
const CATEGORIES=["Home & Kitchen","Electronics","Packaging","Apparel","Beauty & Personal Care","Toys & Games","Stationery","Automotive Accessories","Home Decor","Footwear","Fitness","Pet Supplies","Grocery & Gourmet (NP)","Hardware & Tools"];
const TITLE_BANK={ "Home & Kitchen":["Triply Steel Kadai","Non-Stick Fry Pan 26cm","Mixer Jar 1.5L","Borosilicate Storage Jar 900ml","Pressure Cooker 5L ISI"], "Electronics":["65W GaN Charger BIS","Smart LED Bulb 12W B22","Type-C Cable 60W Nylon","Bluetooth Earbuds ENC","Power Bank 20,000mAh"], "Packaging":["Kraft Logo Boxes 200gsm","Bubble Mailers 10x12","Ziplock Pouches 6x9","Brand Stickers 3x3","Honeycomb Wrap 50m"], "Apparel":["Cotton Polo 220GSM","Oversized Tee 240GSM","Hoodie Fleece 320GSM","Active Shorts","Socks Ankle Cotton"], "Beauty & Personal Care":["Aloe Face Gel 100g","Herbal Shampoo 200ml","Beard Oil 30ml","Lip Balm Cocoa 8g","Vitamin C Serum 30ml"], "Toys & Games":["Wooden Puzzle 24pc","STEM Kit Solar Car","Plush Toy 25cm","Foam Dart Blaster","Chess Magnetic"], "Stationery":["A5 Notebook 200 pages","Gel Pens 0.5mm (10)","Highlighters (5)","Sticky Notes 3x3","Whiteboard Marker (4)"], "Automotive Accessories":["Phone Holder Dashboard","Car Vacuum 120W","Seat Gap Filler","Tyre Inflator 12V","Microfiber Wash Mitt"], "Home Decor":["LED Curtain Lights","Macrame Wall Hanging","Planter Pot 6in","Table Lamp Minimal","Wall Clock Metal"], "Footwear":["PU Sliders","Running Shoes","Leather Formal Belt","Ankle Sneakers","Flip Flops EVA"], "Fitness":["Resistance Bands Set","Yoga Mat TPE 6mm","Shaker Bottle 700ml","Skipping Rope Steel","Foam Roller"], "Pet Supplies":["Dog Leash Nylon","Cat Scratcher Board","Pet Water Bowl","Grooming Brush","Pet Treat Pouch"], "Grocery & Gourmet (NP)":["Filter Coffee 250g","Whole Oats 1kg","Dry Fruit Mix 500g","Herbal Tea 100g","Peanut Butter 1kg"], "Hardware & Tools":["Drill Bits Set (13)","Screwdriver Set (8)","Adjustable Wrench 12in","Measuring Tape 5m","Utility Knife"] };
const SUPPLIERS=["Shakti Steelware","Bangalore Tech Hub","PackRight India","Surat Knit Co.","Delhi Bright Labs","Mumbai Cookware Depot","Ahmedabad Apparel Park","Hyderabad Plastics","Jaipur Craft Lines","Noida Tech Mart","Chennai Home Co.","Pune Fit Gear","Gurugram Auto Hub","Kolkata Paper Works","Ludhiana Footwear Assoc."];

const rand=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
const choice=arr=>arr[rand(0,arr.length-1)];
const bool=(p=0.5)=>Math.random()<p;

function makeTitle(category){ const t=choice(TITLE_BANK[category]); const variant=["Pro","Max","BIS","ISI","Eco","Plus","X","Lite"][rand(0,7)]; return `${t} • ${variant}`; }
function priceByCategory(cat){ const ranges={ "Home & Kitchen":[199,1299],"Electronics":[99,1999],"Packaging":[2,60],"Apparel":[120,699],"Beauty & Personal Care":[29,499],"Toys & Games":[59,799],"Stationery":[3,199],"Automotive Accessories":[59,1499],"Home Decor":[79,1499],"Footwear":[149,1499],"Fitness":[79,1299],"Pet Supplies":[49,699],"Grocery & Gourmet (NP)":[49,599],"Hardware & Tools":[59,1699] }; const [lo,hi]=ranges[cat]; return rand(lo,hi); }
function tiersFromBase(base){ const p1=Math.max(2,Math.round(base*1.00)),p2=Math.round(base*0.95),p3=Math.round(base*0.88); const q1=["12+","20+","24+","30+","40+"][rand(0,4)],q2=["100+","120+","200+","300+"][rand(0,3)],q3=["500+","800+","1000+","2000+"][rand(0,3)]; return [{q:q1,p:`₹${p1.toLocaleString("en-IN")}`},{q:q2,p:`₹${p2.toLocaleString("en-IN")}`},{q:q3,p:`₹${p3.toLocaleString("en-IN")}`}]; }
function makeProduct(i){ const category=choice(CATEGORIES),supplier=choice(SUPPLIERS),supplierType=choice(SUPPLIER_TYPES),state=choice(STATES),base=priceByCategory(category),moq=[12,20,24,30,40,50,60,100][rand(0,7)]; const title=makeTitle(category); return { id:`K-${String(i).padStart(3,"0")}`, title, category, supplier, supplierType, state, moq, price:base, tiers:tiersFromBase(base), gstVerified:bool(0.8), dropshipReady:bool(0.55), creditEligible:bool(0.6), logistics:bool(0.75), brandPackaging:bool(0.5), ecoPack:bool(0.35), sameDay:bool(0.25), sampleAllowed:bool(0.9), thumb:"" }; }
const PRODUCTS=Array.from({length:100},(_,i)=>makeProduct(i+1));

/* ===== STATE ===== */
let state={ q:"", sort:"relevance", page:1, perPage:12,
  filters:{ supplierType:new Set(SUPPLIER_TYPES), category:new Set(CATEGORIES), state:"", gstVerified:false, dropshipReady:false, creditEligible:false, logistics:false, brandPackaging:false, ecoPack:false, sameDay:false, moqMax:null, priceMin:null, priceMax:null }
};
const SAMPLE_CART=new Map();
const $=sel=>document.querySelector(sel), $$=sel=>Array.from(document.querySelectorAll(sel));

function buildSupplierFacet(){ $("#facet-supplier-type").innerHTML=SUPPLIER_TYPES.map(t=>`<label><input type="checkbox" class="fx" data-key="supplierType" value="${t}" checked />${t}</label>`).join(""); }
function buildCategoryFacet(){ $("#facet-categories").innerHTML=CATEGORIES.map(c=>`<label><input type="checkbox" class="fx" data-key="category" value="${c}" checked />${c}</label>`).join(""); }
function buildStateFacet(){ $("#facet-state").innerHTML = `<option value="">All India</option>` + STATES.map(s=>`<option value="${s}">${s}</option>`).join(""); }

function passFilters(p){
  const f=state.filters;
  if(!f.supplierType.has(p.supplierType)) return false;
  if(!f.category.has(p.category)) return false;
  if(f.state && p.state!==f.state) return false;
  if(f.gstVerified && !p.gstVerified) return false;
  if(f.dropshipReady && !p.dropshipReady) return false;
  if(f.creditEligible && !p.creditEligible) return false;
  if(f.logistics && !p.logistics) return false;
  if(f.brandPackaging && !p.brandPackaging) return false;
  if(f.ecoPack && !p.ecoPack) return false;
  if(f.sameDay && !p.sameDay) return false;
  if(f.moqMax!=null && p.moq>Number(f.moqMax)) return false;
  if(f.priceMin!=null && p.price<Number(f.priceMin)) return false;
  if(f.priceMax!=null && p.price>Number(f.priceMax)) return false;
  if(state.q){
    const q=state.q.trim().toLowerCase();
    const hay=(p.title+" "+p.supplier+" "+p.category+" "+p.id).toLowerCase();
    if(!hay.includes(q)) return false;
  }
  return true;
}
function sortProducts(list){
  switch(state.sort){
    case "priceAsc": return list.sort((a,b)=>a.price-b.price);
    case "priceDesc": return list.sort((a,b)=>b.price-a.price);
    case "moqAsc": return list.sort((a,b)=>a.moq-b.moq);
    case "supplierAsc": return list.sort((a,b)=>a.supplier.localeCompare(b.supplier));
    default: return list;
  }
}
function ribbon(p){ const r=[]; if(p.sameDay) r.push("Same-day Dispatch"); else if(p.logistics) r.push("Kyrtica Fulfilled"); else if(p.dropshipReady) r.push("Dropship-Ready"); return r[0]||""; }
function tagsHTML(p){ return `
  ${p.gstVerified?`<span class="tag">GST-Verified</span>`:""}
  ${p.dropshipReady?`<span class="tag">Dropship-Ready</span>`:""}
  ${p.creditEligible?`<span class="tag">Credit-Eligible</span>`:""}
  ${p.logistics?`<span class="tag">Kyrtica Fulfilled</span>`:""}
  ${p.brandPackaging?`<span class="tag brand">Brand Packaging</span>`:""}
  ${p.ecoPack?`<span class="tag">Eco-Packaging</span>`:""}
`; }
function cardHTML(p){
  const tiersHTML=p.tiers.map(t=>`<div class="tier"><div class="q">${t.q}</div><div class="p">${t.p}</div></div>`).join("");
  const rb=ribbon(p);
  const inCart=SAMPLE_CART.has(p.id);
  return `
    <article class="card" data-id="${p.id}">
      <div class="thumb">${rb?`<div class="ribbon">${rb}</div>`:""}<span>${p.category}</span></div>
      <div class="body">
        <div class="title">${p.title}</div>
        <div class="supplier-line" style="font-size:12px;color:#c9c9c9">${p.supplier} • ${p.supplierType} • ${p.state}</div>
        <div class="tags">${tagsHTML(p)}</div>
        <div class="kv">MOQ: <b>${p.moq}</b> • Base: <b>₹${p.price.toLocaleString("en-IN")}</b></div>
        <div class="tiers">${tiersHTML}</div>
        <div class="foot">
          <button class="btn btn-primary btn-enquire">Enquire</button>
          <button class="btn btn-ghost btn-shortlist">Add to List</button>
          ${p.sampleAllowed?`<button class="btn ${inCart?'btn-primary':'btn-ghost'} btn-sample">${inCart?'Added Sample':'Add Sample'}</button>`:""}
        </div>
      </div>
    </article>
  `;
}
function renderPager(pages){
  const wrap=document.getElementById("pager");
  if(pages<=1){ wrap.innerHTML=""; return; }
  let html=""; for(let i=1;i<=pages;i++){ html+=`<button class="${i===state.page?'active':''}" onclick="gotoPage(${i})">${i}</button>`; }
  wrap.innerHTML=html;
}
window.gotoPage=(n)=>{ state.page=n; render(); };

function wireCardButtons(){
  document.querySelectorAll("#cards .card").forEach(card=>{
    const id=card.getAttribute("data-id");
    const p=PRODUCTS.find(x=>x.id===id);
    card.querySelector(".btn-enquire")?.addEventListener("click",()=>alert(`Enquiry sent to ${p.supplier} for ${p.title} (${p.id})`));
    card.querySelector(".btn-shortlist")?.addEventListener("click",()=>alert(`Added ${p.id} to your shortlist`));
    const btnSample=card.querySelector(".btn-sample");
    if(btnSample && p.sampleAllowed){
      btnSample.addEventListener("click", ()=>{
        if(SAMPLE_CART.has(id)){ const item=SAMPLE_CART.get(id); item.qty=Math.min(5,item.qty+1); SAMPLE_CART.set(id,item); }
        else { SAMPLE_CART.set(id,{product:p,qty:1}); }
        renderSampleCart();
        btnSample.classList.remove("btn-ghost"); btnSample.classList.add("btn-primary"); btnSample.textContent="Added Sample";
      });
    }
  });
}

function renderSampleCart(){
  const lines=document.getElementById("sample-lines");
  if(SAMPLE_CART.size===0){
    lines.innerHTML=`<div class="small">No samples selected yet.</div>`;
  }else{
    lines.innerHTML=Array.from(SAMPLE_CART.values()).map(({product,qty})=>`
      <div class="cart-line" data-id="${product.id}">
        <div style="flex:1">
          <div style="font-weight:700;font-size:13px">${product.title}</div>
          <div class="small">${product.supplier} • ${product.state}</div>
        </div>
        <div class="qctrl">
          <button class="dec">−</button><div>${qty}</div><button class="inc">+</button>
        </div>
        <button class="btn" style="padding:6px 10px" data-remove>Remove</button>
      </div>`).join("");
  }
  document.getElementById("sample-count").textContent=`(${SAMPLE_CART.size} items)`;
  document.querySelectorAll("#sample-lines .cart-line").forEach(line=>{
    const id=line.getAttribute("data-id");
    line.querySelector(".dec").addEventListener("click", ()=>{ const it=SAMPLE_CART.get(id); if(!it) return; it.qty=Math.max(1,it.qty-1); SAMPLE_CART.set(id,it); renderSampleCart(); });
    line.querySelector(".inc").addEventListener("click", ()=>{ const it=SAMPLE_CART.get(id); if(!it) return; it.qty=Math.min(5,it.qty+1); SAMPLE_CART.set(id,it); renderSampleCart(); });
    line.querySelector("[data-remove]").addEventListener("click", ()=>{ SAMPLE_CART.delete(id); renderSampleCart(); const cardBtn=document.querySelector(`.card[data-id="${id}"] .btn-sample`); if(cardBtn){ cardBtn.classList.remove("btn-primary"); cardBtn.classList.add("btn-ghost"); cardBtn.textContent="Add Sample"; } });
  });
}

function render(){
  let filtered=PRODUCTS.filter(passFilters);
  filtered=sortProducts(filtered);
  const total=filtered.length;
  const pages=Math.max(1,Math.ceil(total/state.perPage));
  if(state.page>pages) state.page=pages;
  const start=(state.page-1)*state.perPage;
  const items=filtered.slice(start,start+state.perPage);
  document.getElementById("count").textContent=total;
  document.getElementById("cards").innerHTML=items.map(cardHTML).join("");
  renderPager(pages);
  wireCardButtons();
  renderSampleCart();
}

function wireFilters(){
  document.getElementById("q").addEventListener("input", e=>{ state.q=e.target.value; state.page=1; render(); });
  document.getElementById("sort").addEventListener("change", e=>{ state.sort=e.target.value; state.page=1; render(); });
  document.addEventListener("change", e=>{
    const el=e.target;
    if(!el.classList?.contains("fx")) return;
    const key=el.dataset.key;
    if(el.type==="checkbox" && (key==="supplierType"||key==="category")){
      const set=state.filters[key]; if(el.checked) set.add(el.value); else set.delete(el.value);
    } else if(el.type==="checkbox"){ state.filters[key]=el.checked?true:false;
    } else {
      const val=el.value;
      if(["moqMax","priceMin","priceMax"].includes(key)) state.filters[key]=val===""?null:Number(val);
      else state.filters[key]=val;
    }
    state.page=1; render();
  });
  document.getElementById("reset").addEventListener("click", ()=>{
    state={ q:"", sort:"relevance", page:1, perPage:12,
      filters:{ supplierType:new Set(SUPPLIER_TYPES), category:new Set(CATEGORIES), state:"", gstVerified:false, dropshipReady:false, creditEligible:false, logistics:false, brandPackaging:false, ecoPack:false, sameDay:false, moqMax:null, priceMin:null, priceMax:null }
    };
    document.getElementById("q").value=""; document.getElementById("sort").value="relevance"; document.getElementById("facet-state").value="";
    document.querySelectorAll(".fx[type='number']").forEach(n=>n.value="");
    buildSupplierFacet(); buildCategoryFacet(); render();
  });
  document.getElementById("clear-samples").addEventListener("click", ()=>{ SAMPLE_CART.clear(); renderSampleCart(); render(); });
}

/* Bootstrap */
buildSupplierFacet(); buildCategoryFacet(); buildStateFacet(); wireFilters(); render();

/* Modal */
const modal=document.getElementById("sample-modal");
document.getElementById("btn-request-samples").addEventListener("click", ()=>{
  if(SAMPLE_CART.size===0){ alert("Add at least one sample item."); return; }
  const list=Array.from(SAMPLE_CART.values()).map(it=>`${it.product.id} x ${it.qty}`).join(", ");
  document.getElementById("sample-summary").textContent = `You’re requesting samples for ${SAMPLE_CART.size} item(s): ${list}`;
  modal.style.display="flex";
});
document.getElementById("close-modal").addEventListener("click", ()=> modal.style.display="none");
document.getElementById("submit-samples").addEventListener("click", ()=>{
  const name=document.getElementById("buyer-name").value.trim();
  const phone=document.getElementById("buyer-phone").value.trim();
  if(!name || !phone){ alert("Please fill your name and phone."); return; }
  alert("Sample request submitted. Our suppliers will contact you shortly.");
  modal.style.display="none";
});
</script>
</body>
</html>
