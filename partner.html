<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Partner With Us — Kyrtica</title>
  <meta name="description" content="Onboard as wholesaler, retailer, or logistics partner.">
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="styles.css">

  <!-- Inline modal & validation styles -->
  <style>
    :root { --overlay: rgba(0,0,0,.5); --modal:#151515; --ring:#2a2a2a; }
    .modal-backdrop{position:fixed;inset:0;background:var(--overlay);display:none;align-items:center;justify-content:center;padding:16px;z-index:999}
    .modal-backdrop.show{display:flex;animation:fadeIn .2s ease-out}@keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .modal{width:min(760px,100%);max-height:90vh;overflow:auto;background:var(--modal);border:1px solid #262626;border-radius:16px;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,.45);animation:scaleIn .18s ease-out;position:relative}
    @keyframes scaleIn{from{transform:scale(.98);opacity:.0}to{transform:scale(1);opacity:1}}
    .modal-header h2{margin:0 0 6px}
    .modal-close{position:absolute;top:10px;right:10px;background:#0e0e0e;border:1px solid #2b2b2b;color:#eee;border-radius:10px;padding:6px 10px;cursor:pointer}
    .grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}@media(max-width:700px){.grid-2{grid-template-columns:1fr}}
    .form input,.form textarea,.form select{width:100%;background:#0e0e0e;color:#eaecef;border:1px solid #2a2a2a;border-radius:12px;padding:12px}
    .form textarea{resize:vertical}
    .form input:focus,.form textarea:focus,.form select:focus{outline:none;border-color:#3a3a3a;box-shadow:0 0 0 3px rgba(229,183,0,.15)}
    .modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
    .error-hint{color:#ffb3b3;font-size:.85rem;margin-top:6px;display:none}
    .input-error{border-color:#7a2b2b!important;box-shadow:0 0 0 3px rgba(255,0,0,.1)!important}
    .toast-root{position:fixed;z-index:1000;right:16px;bottom:16px;display:grid;gap:10px}
    .toast{background:#141414;border:1px solid #2a2a2a;border-left:4px solid #5bb98a;padding:12px 14px;border-radius:12px;box-shadow:0 12px 28px rgba(0,0,0,.35);animation:toastIn .2s ease-out}
    .toast.error{border-left-color:#e55}@keyframes toastIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
  </style>
</head>
<body>
<header class="site-header">
  <div class="container nav">
    <!-- Left: brand -->
    <a class="brand" href="index.html">
      <img src="assets/logo.svg" alt="Kyrtica" width="28" height="28"><span>Kyrtica</span>
    </a>

    <!-- Middle: main nav -->
    <nav class="menu">
      <a href="index.html" class="nav-home">Home</a>
      <a href="marketplace.html">Marketplace</a>
      <a href="services.html">Services</a>
      <a href="partner.html">Partner</a>
      <a href="learning.html">Learning</a>
      <a href="contact.html">Contact</a>
    </nav>

    <!-- Right: language/currency + auth -->
    <div class="topbar-right">
      <div class="selects">
        <select id="langSel" aria-label="Language">
          <option>English</option>
          <option>हिन्दी</option>
          <option>தமிழ்</option>
          <option>తెలుగు</option>
        </select>
        <select id="curSel" aria-label="Currency">
          <option value="INR">INR ₹</option>
          <option value="USD">USD $</option>
        </select>
      </div>
      <a class="btn btn-ghost small" href="signin.html">Sign In</a>
      <a class="btn btn-primary small" href="register.html">Register</a>
      <button class="menu-toggle" aria-label="Open menu">☰</button>
    </div>
  </div>
</header>

<main class="page container">
  <h1 class="page-title">Partner With Us</h1>
  <p class="muted">Choose your role to get started. We’ll only ask for what’s needed.</p>

  <section class="grid-3 cards animate-in">
    <div class="info-card">
      <h3>Wholesalers</h3>
      <p>List products with tiered pricing, MOQs and dispatch SLAs.</p>
      <button class="btn btn-primary open-modal" data-role="wholesaler">Apply as Wholesaler</button>
    </div>
    <div class="info-card">
      <h3>Retailers</h3>
      <p>Discover suppliers, request quotes and sync products to your store.</p>
      <button class="btn btn-primary open-modal" data-role="retailer">Join as Retailer</button>
    </div>
    <div class="info-card">
      <h3>Logistics Partners</h3>
      <p>Offer competitive lane rates and scale with our B2B network.</p>
      <button class="btn btn-primary open-modal" data-role="logistics">Partner with Kyrtica</button>
    </div>
  </section>
</main>

<div id="toast-root" class="toast-root" aria-live="polite" aria-atomic="true"></div>

<!-- Modal -->
<div class="modal-backdrop" id="modal" aria-hidden="true" role="dialog">
  <div class="modal" role="document">
    <button class="modal-close" aria-label="Close">✕</button>
    <div class="modal-header">
      <h2 id="modal-title">Apply</h2>
      <p class="muted small" id="modal-subtitle">Tell us a few details to get started.</p>
    </div>

    <!-- We disable native validation -->
    <form id="partner-form" class="form" action="https://formspree.io/f/xbldjylv" method="POST" novalidate>
      <input type="hidden" name="role" id="role-field" value="">
      <input type="hidden" name="utm_source" id="utm_source">
      <input type="hidden" name="utm_medium" id="utm_medium">
      <input type="hidden" name="utm_campaign" id="utm_campaign">
      <input type="hidden" name="utm_content" id="utm_content">
      <input type="hidden" name="utm_term" id="utm_term">

      <div class="grid-2" id="dynamic-fields"></div>

      <textarea name="notes" rows="4" class="full" placeholder="Anything else we should know?"></textarea>
      <div class="modal-actions">
        <button type="button" class="btn btn-ghost modal-cancel">Cancel</button>
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>
  </div>
</div>

<footer class="site-footer">
  <div class="container footer-grid">
    <div>
      <div class="brand-row"><img src="assets/logo.svg" width="22" height="22" alt="Kyrtica"><strong>Kyrtica</strong></div>
      <p class="muted">© 2025 Kyrtica — Built for Indian B2B dropshipping.</p>
    </div>
    <nav class="footer-links">
      <a href="about.html">About</a>
      <a href="privacy.html">Privacy</a>
      <a href="terms.html">Terms</a>
      <a href="sitemap.xml">Sitemap</a>
    </nav>
  </div>
</footer>

<script>
(function(){
  const modal=document.getElementById('modal'),form=document.getElementById('partner-form'),roleField=document.getElementById('role-field'),fieldsWrap=document.getElementById('dynamic-fields'),toastRoot=document.getElementById('toast-root');
  if(!modal||!form)return;

  function showToast(msg,isError=false){const t=document.createElement('div');t.className='toast'+(isError?' error':'');t.textContent=msg;toastRoot.appendChild(t);setTimeout(()=>t.remove(),4200)}

  // UTM capture
  const params=new URLSearchParams(window.location.search);
  ['utm_source','utm_medium','utm_campaign','utm_content','utm_term'].forEach(k=>{
    const v=params.get(k)||sessionStorage.getItem(k)||'';if(v)sessionStorage.setItem(k,v);
    const el=document.getElementById(k);if(el)el.value=v||'';
  });

  const STATES=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi","Jammu and Kashmir","Ladakh"];

  const COMMON=[
    {n:'business_name',ph:'Business Name',req:true},
    {n:'signatory_name',ph:'Authorised Signatory Name',req:true},
    {n:'contact',ph:'Mobile Number',req:true},
    {n:'email',ph:'Email',type:'email',req:true},
    {n:'gst',ph:'GSTIN'},
    {n:'state',type:'select',ph:'State',req:true,opts:STATES},
    {n:'city',ph:'City',req:true},
    {n:'pincode',ph:'Pincode (6 digits)',req:true},
    {n:'address',type:'textarea',ph:'Full Address (Door No, Street, Area)',req:true,full:true}
  ];

  const roles={
    wholesaler:{title:'Apply as Wholesaler',sub:'Tell us about your catalog.',f:[...COMMON,{n:'categories',ph:'Categories (e.g., kitchenware, electronics)'},{n:'moq',ph:'Typical MOQ (e.g., 20, 50)'},{n:'website',ph:'Website (optional)'}]},
    retailer:{title:'Join as Retailer',sub:'We’ll help you source and sync products.',f:[...COMMON,{n:'store_name',ph:'Store Name',req:true},{n:'platform',ph:'Platform (Shopify / Woo / Dukaan)',req:true},{n:'monthly_orders',ph:'Estimated Monthly Orders'}]},
    logistics:{title:'Partner as Logistics',sub:'Share your coverage and services.',f:[...COMMON,{n:'coverage',ph:'Coverage (states/cities)'},{n:'services',ph:'Services (FTL / PTL / Courier)'}]}
  };

  function openFor(r){const cfg=roles[r];if(!cfg)return;
    document.getElementById('modal-title').textContent=cfg.title;
    document.getElementById('modal-subtitle').textContent=cfg.sub;
    roleField.value=r;fieldsWrap.innerHTML='';
    cfg.f.forEach(f=>{
      let el; if(f.type==='select'){el=document.createElement('select');el.name=f.n;if(f.req)el.required=true;const def=document.createElement('option');def.value='';def.textContent=f.ph;def.disabled=true;def.selected=true;el.appendChild(def);(f.opts||[]).forEach(o=>{const opt=document.createElement('option');opt.value=o;opt.textContent=o;el.appendChild(opt)});}
      else if(f.type==='textarea'){el=document.createElement('textarea');el.name=f.n;el.placeholder=f.ph;el.rows=3;if(f.req)el.required=true;if(f.full)el.classList.add('full')}
      else{el=document.createElement('input');el.name=f.n;el.type=f.type||'text';el.placeholder=f.ph;if(f.req)el.required=true}
      fieldsWrap.appendChild(el);
    });
    modal.classList.add('show');modal.setAttribute('aria-hidden','false');
  }

  function closeModal(){modal.classList.remove('show');modal.setAttribute('aria-hidden','true')}

  document.querySelectorAll('.open-modal').forEach(b=>b.addEventListener('click',()=>openFor(b.dataset.role)));
  modal.querySelector('.modal-close').addEventListener('click',closeModal);
  modal.querySelector('.modal-cancel').addEventListener('click',closeModal);
  modal.addEventListener('click',e=>{if(e.target===modal)closeModal()});
  document.addEventListener('keydown',e=>{if(e.key==='Escape'&&modal.classList.contains('show'))closeModal()});

  function setErr(i,m){let h=i.nextElementSibling;if(!h||!h.classList.contains('error-hint')){h=document.createElement('div');h.className='error-hint';i.insertAdjacentElement('afterend',h)}h.textContent=m;h.style.display='block';i.classList.add('input-error')}
  function clrErr(i){const h=i.nextElementSibling;if(h&&h.classList.contains('error-hint')){h.style.display='none';h.textContent=''}i.classList.remove('input-error')}
  function validate(i){clrErr(i);const v=(i.value||'').trim(),n=i.name;
    if(i.required&&!v){setErr(i,'This field is required');return false;}
    if(n==='email'&&v&&!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(v)){setErr(i,'Enter a valid email');return false;}
    if(n==='contact'&&v&&!/^[6-9]\\d{9}$/.test(v)){setErr(i,'Enter a valid 10-digit mobile');return false;}
    if(n==='pincode'&&v&&!/^\\d{6}$/.test(v)){setErr(i,'Enter a valid 6-digit pincode');return false;}
    if(n==='gst'&&v&&!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/.test(v.toUpperCase())){setErr(i,'GSTIN format looks invalid');return false;}
    return true;
  }

  form.addEventListener('focusout',e=>{const t=e.target;if(t&&/^(INPUT|SELECT|TEXTAREA)$/.test(t.tagName))validate(t)});

  form.addEventListener('submit',async e=>{
    e.preventDefault();
    const all=form.querySelectorAll('input,select,textarea');
    let ok=true;all.forEach(x=>{if(!validate(x))ok=false});
    if(!ok){showToast('Please fix highlighted fields.',true);return;}
    try{
      const fd=new FormData(form);
      fd.append('submitted_at',new Date().toISOString());
      fd.append('page',location.pathname+location.search);
      const r=await fetch(form.action,{method:'POST',body:fd,headers:{'Accept':'application/json'}});
      if(r.ok){showToast('Thanks! Submitted successfully.');form.reset();setTimeout(closeModal,600)}
      else showToast('Submission failed. Try again.',true);
    }catch(err){showToast('Network error. Try again.',true)}
  });
})();
</script>
</body>
</html>
